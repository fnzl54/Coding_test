-- https://school.programmers.co.kr/learn/courses/30/lessons/133027
SELECT F.FLAVOR
FROM FIRST_HALF F
JOIN (  SELECT H.FLAVOR, SUM(J.TOTAL_ORDER) as JULY_SUM
        FROM FIRST_HALF H
        JOIN JULY J
        ON H.FLAVOR = J.FLAVOR
        GROUP BY H.FLAVOR ) JFJ
ON F.FLAVOR = JFJ.FLAVOR
ORDER BY F.TOTAL_ORDER + JFJ.JULY_SUM DESC LIMIT 3